<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-5.0.2"><title>Senzory - VAMZ</title><link rel=stylesheet href=../assets/stylesheets/main.07c9fbf5.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ecd4686e.min.css><meta name=theme-color content=#3f51b5><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../stylesheets/extra.css></head> <body dir=ltr data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#senzory class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=.. title=VAMZ class="md-header-nav__button md-logo" aria-label=VAMZ> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z /></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> VAMZ </span> <span class="md-header-nav__topic md-ellipsis"> Senzory </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z /></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> Procesy a vlákna <small>(multithreding)</small> </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=VAMZ class="md-nav__button md-logo" aria-label=VAMZ> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> VAMZ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title="Procesy a vlákna (multithreding)" class=md-nav__link> Procesy a vlákna <small>(multithreding)</small> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Senzory <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z /></svg> </span> </label> <a href=./ title=Senzory class="md-nav__link md-nav__link--active"> Senzory </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#uvod-do-senzorov class=md-nav__link> Úvod do senzorov </a> <nav class=md-nav aria-label="Úvod do senzorov"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#framework class=md-nav__link> Framework </a> </li> <li class=md-nav__item> <a href=#identifikovanie-senzorov-a-ich-vlastnosti class=md-nav__link> Identifikovanie senzorov a ich vlastnosti </a> </li> <li class=md-nav__item> <a href=#komunikacia-so-senzormi class=md-nav__link> Komunikácia so senzormi </a> </li> <li class=md-nav__item> <a href=#vysporiadanie-sa-s-roznorodostou-android-zariadeni class=md-nav__link> Vysporiadanie sa s rôznorodosťou Android zariadení </a> </li> <li class=md-nav__item> <a href=#suradnicovy-system-senzorov class=md-nav__link> Súradnicový systém senzorov </a> </li> <li class=md-nav__item> <a href=#osvedcene-postupy-pre-pristup-a-pouzivanie-senzorov class=md-nav__link> Osvedčené postupy pre prístup a používanie senzorov </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#urcenie-polohy-satelitna-navigacia class=md-nav__link> Určenie polohy / Satelitná navigácia </a> <nav class=md-nav aria-label="Určenie polohy / Satelitná navigácia"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sluzba-google-location-api class=md-nav__link> Služba Google Location API </a> <nav class=md-nav aria-label="Služba Google Location API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#uzitocne-odkazy class=md-nav__link> Užitočné odkazy </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#uvod-do-senzorov class=md-nav__link> Úvod do senzorov </a> <nav class=md-nav aria-label="Úvod do senzorov"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#framework class=md-nav__link> Framework </a> </li> <li class=md-nav__item> <a href=#identifikovanie-senzorov-a-ich-vlastnosti class=md-nav__link> Identifikovanie senzorov a ich vlastnosti </a> </li> <li class=md-nav__item> <a href=#komunikacia-so-senzormi class=md-nav__link> Komunikácia so senzormi </a> </li> <li class=md-nav__item> <a href=#vysporiadanie-sa-s-roznorodostou-android-zariadeni class=md-nav__link> Vysporiadanie sa s rôznorodosťou Android zariadení </a> </li> <li class=md-nav__item> <a href=#suradnicovy-system-senzorov class=md-nav__link> Súradnicový systém senzorov </a> </li> <li class=md-nav__item> <a href=#osvedcene-postupy-pre-pristup-a-pouzivanie-senzorov class=md-nav__link> Osvedčené postupy pre prístup a používanie senzorov </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#urcenie-polohy-satelitna-navigacia class=md-nav__link> Určenie polohy / Satelitná navigácia </a> <nav class=md-nav aria-label="Určenie polohy / Satelitná navigácia"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sluzba-google-location-api class=md-nav__link> Služba Google Location API </a> <nav class=md-nav aria-label="Služba Google Location API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#uzitocne-odkazy class=md-nav__link> Užitočné odkazy </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=senzory>Senzory<a class=headerlink href=#senzory title="Permanent link">&para;</a></h1> <p>Táto prednáška sa zaoberá témou vstavaných senzorov v systéme Android ale aj lokalizačným podsystémom Location API.</p> <h2 id=uvod-do-senzorov>Úvod do senzorov<a class=headerlink href=#uvod-do-senzorov title="Permanent link">&para;</a></h2> <p>Väčšina dnešných Android zariadení obsahuje vstavané senzory, ktoré umožňujú merať zrýchlenie, natočenie zariadenia a mnoho ďalších fyzikálnych veličín. Tieto senzory sú schopné poskytnúť surové dáta s veľkou presnosťou a vo veľkom rozsahu a sú užitočné, ak chceme monitorovať pohyb alebo polohu zariadenia v trojrozmernom priestore alebo ak chceme monitorovať zmeny okolitého prostredia v blízkosti zariadenia. Napríklad hra môže sledovať údaje z akcelerometra a identifikovať zložité gestá a pohyby používateľa, ako napríklad naklonenie, chvenie, rotácia a pod. Podobne aj aplikácia na počasie môže na výpočet a určenie rosného bodu použiť snímač teploty a vlhkosti alebo navigácia môže využiť dáta z trojosového magnetometra, ktorý sníma geomagnetické pole Zeme a dáta z akcelerometra na spresnenie navigácie. </p> <p>Platforma Android podporuje tri kategórie senzorov:</p> <ul> <li>Pohybové senzory</li> </ul> <p>Tieto senzory merajú fyzikálne veličiny ako: zrýchlenie a rotačné sily pozdĺž troch osí. Do tejto kategórie patria akcelerometre, gravitačné senzory, gyroskopy a senzory natočenia.</p> <ul> <li>Senzory prostredia</li> </ul> <p>Tieto senzory merajú rôzne parametre prostredia, ako je teplota a tlak okolitého vzduchu, osvetlenie a vlhkosť. Táto kategória zahŕňa barometre, fotometre (meranie intenzity svetla) a teplomery.</p> <ul> <li>Polohové senzory</li> </ul> <p>Tieto senzory merajú fyzickú polohu zariadenia. Táto kategória zahŕňa senzory orientácie a magnetometre.</p> <p>V systéme Android môžeme senzory ešte rozdeliť podľa toho, či údaje pochádzajú priamo z fyzického senzora alebo ide o softvérový senzor, ktorý poskytuje už predspracované dáta. Predspracovanie dát môže zahŕňať napríklad: filtrovanie dát, fúziu dát z rôznych senzorov alebo transformovanie dát do inej formy. Hardvérové senzory odvodzujú údaje priamym meraním špecifických vlastností prostredia.</p> <p>Medzi hardvérové senzory radíme: </p> <ul> <li>Mikrofón</li> <li>Kamera</li> <li>Teplota</li> <li>Poloha (GPS)</li> <li>Accelerometer</li> <li>Proximity</li> <li>Tlak</li> <li>Svetelnosť</li> </ul> <p>Medzi softvérové radíme:</p> <ul> <li>Gravitácia</li> <li>Lineárna akcelerácia</li> <li>Orientácia</li> </ul> <p>Android poskytuje rozsiahly framework na prístup k senzorom. Tento framework poskytuje niekoľko tried a rozhraní, ktoré môžeme využiť napríklad na:</p> <ul> <li>Určiť aké senzory sú k dispozícii na danom zariadení. Každý výrobca zariadení si sám určuje akým senzormi osadí svoje zariadenia. Nie je to štandardizované. </li> <li>Určiť vlastnosti jednotlivých snímačov, napríklad maximálny dosah, výrobca, požiadavky na napájanie a rozlíšenie.</li> <li>Získať surové údaje zo snímača a definujte <strong>minimálnu</strong> vzorkovaciu frekvenciu (ako často dostávame dáta ). Slovíčko minimálne je použité z toho dôvodu, že senzory sú zdielané medzi všetkými aplikáciami zariadenia. V prípade ak niektorá aplikácia požaduje vyššiu vzorkovaciu frekvenciu ako postačovala pre našu aplikáciu, tak vzorkovacia frekvencia sa zvýši, čo ovplyvni aj vzorkovanie pre našu aplikáciu. Hodnota vzorkovacej frekvencie ale nemôže klesnúť pod nami nastavené minimum. </li> <li>Zaregistrovanie a zrušenie registrácie na odoberanie udalostí od senzora. Príklady udalostí, na ktoré sa môžeme registrovať sú: nová hodnota, zmena presnosti, zmena citlivosti a pod. </li> </ul> <p>Málo zariadení so systémom Android má každý typ senzora. Napríklad väčšina mobilných telefónov a tabletov má akcelerometer a magnetometer, ale menej prístrojov má barometre alebo teplomery. Zariadenie môže mať tiež viac ako jeden senzor daného typu. Napríklad zariadenie môže mať dva snímače gravitácie, z ktorých každý má iný rozsah. </p> <table> <thead> <tr> <th align=left>senzor</th> <th align=left>typ</th> <th align=left>popis</th> <th align=left>Bežné použitia</th> </tr> </thead> <tbody> <tr> <td align=left><code>TYPE_ACCELEROMETER</code></td> <td align=left>hardvér</td> <td align=left>Zmeria silu zrýchlenia v <span><span class=MathJax_Preview>m/s^2</span><script type=math/tex>m/s^2</script></span> , ktorá pôsobí na zariadenie vo všetkých troch osách (x, y a z), vrátane gravitačnej sily.</td> <td align=left>Detekcia pohybu (chvenie, náklon atď.).</td> </tr> <tr> <td align=left><code>TYPE_AMBIENT_TEMPERATURE</code></td> <td align=left>hardvér</td> <td align=left>Zmeria teplotu okolia v stupňoch Celzia (°C). Pozri poznámku nižšie.</td> <td align=left>Monitorovanie teploty vzduchu.</td> </tr> <tr> <td align=left><code>TYPE_GRAVITY</code></td> <td align=left>Softvér alebo hardvér</td> <td align=left>Zmeria gravitačnú silu v <span><span class=MathJax_Preview>m/s^2</span><script type=math/tex>m/s^2</script></span>, ktorá pôsobí na zariadenie na všetkých troch fyzických osách (x, y, z).</td> <td align=left>Detekcia pohybu (chvenie, náklon atď.).</td> </tr> <tr> <td align=left><code>TYPE_GYROSCOPE</code></td> <td align=left>hardvér</td> <td align=left>Zmeria rýchlosť rotácie zariadenia v rad / s okolo každej z troch fyzických osí (x, y a z).</td> <td align=left>Detekcia rotácie (rotácia, otočenie atď.).</td> </tr> <tr> <td align=left><code>TYPE_LIGHT</code></td> <td align=left>hardvér</td> <td align=left>Meria úroveň okolitého svetla (osvetlenie) v <em>lx</em>.</td> <td align=left>Ovládanie jasu obrazovky.</td> </tr> <tr> <td align=left><code>TYPE_LINEAR_ACCELERATION</code></td> <td align=left>Softvér alebo hardvér</td> <td align=left>Zmeria silu zrýchlenia v <span><span class=MathJax_Preview>m/s^2</span><script type=math/tex>m/s^2</script></span>, ktorá pôsobí na zariadenie vo všetkých troch osách (x, y a z), s výnimkou gravitačnej sily.</td> <td align=left>Monitorovanie zrýchlenia pozdĺž jednej osi.</td> </tr> <tr> <td align=left><code>TYPE_MAGNETIC_FIELD</code></td> <td align=left>hardvér</td> <td align=left>Zmeria sa okolité geomagnetické pole pre všetky tri fyzikálne osi (x, y, z) v μT.</td> <td align=left>Vytvorenie kompasu.</td> </tr> <tr> <td align=left><code>TYPE_ORIENTATION</code></td> <td align=left>softvér</td> <td align=left>Zmeria stupne natočenia, ktoré zariadenie vykoná okolo všetkých troch fyzických osí (x, y, z). Od API úrovne 3 môžete získať maticu náklonu a rotačnú maticu pre zariadenie pomocou gravitačného senzora a senzora geomagnetického poľa v spojení s touto metódou<code>getRotationMatrix()</code>.</td> <td align=left>Určenie polohy zariadenia.</td> </tr> <tr> <td align=left><code>TYPE_PRESSURE</code></td> <td align=left>hardvér</td> <td align=left>Zmeria tlak okolitého vzduchu v hPa alebo mbar.</td> <td align=left>Monitorovanie zmien tlaku vzduchu.</td> </tr> <tr> <td align=left><code>TYPE_PROXIMITY</code></td> <td align=left>hardvér</td> <td align=left>Zmeria blízkosť objektu v cm vzhľadom na obrazovku zariadenia. Tento senzor sa zvyčajne používa na určenie, či je slúchadlo držané pri uchu osoby.</td> <td align=left>Poloha telefónu počas hovoru.</td> </tr> <tr> <td align=left><code>TYPE_RELATIVE_HUMIDITY</code></td> <td align=left>hardvér</td> <td align=left>Zmeria relatívnu vlhkosť okolia v percentách (%).</td> <td align=left>Monitorovanie rosného bodu, absolútnej a relatívnej vlhkosti.</td> </tr> <tr> <td align=left><code>TYPE_ROTATION_VECTOR</code></td> <td align=left>Softvér alebo hardvér</td> <td align=left>Zmeria orientáciu zariadenia poskytnutím troch prvkov rotačného vektora zariadenia.</td> <td align=left>Detekcia pohybu a detekcia rotácie.</td> </tr> <tr> <td align=left><code>TYPE_TEMPERATURE</code></td> <td align=left>hardvér</td> <td align=left>Zmeria teplotu zariadenia v stupňoch Celzia (°C). Táto implementácia senzora sa medzi zariadeniami líši a tento senzor bol nahradený <code>TYPE_AMBIENT_TEMPERATURE</code>senzorom v API Level 14</td> <td align=left>Monitorovanie teploty.</td> </tr> </tbody> </table> <h3 id=framework>Framework<a class=headerlink href=#framework title="Permanent link">&para;</a></h3> <p>K senzorom môžete pristupovať a získavať nespracované t.j. surové dáta pomocou frameworku ktorý je súčasťou <code>android.hardware</code>balíka a obsahuje nasledujúce triedy a rozhrania:</p> <ul> <li><code>SensorManager</code></li> </ul> <p>Túto triedu môžete použiť na vytvorenie inštancie služby spätej so senzormi. Táto trieda poskytuje rôzne metódy pre prístup a zoznam senzorov, registráciu a zrušenie registrácie prijímania udalostí senzorov. Táto trieda tiež poskytuje niekoľko konštánt, ktoré sa používajú na definovanie presnosti senzora, nastavenie rýchlosti získavania údajov (vzorkovacia frekvencia) a kalibráciu senzorov.</p> <ul> <li><code>Sensor</code></li> </ul> <p>Túto triedu môžete použiť na vytvorenie inštancie konkrétneho senzora. Táto trieda poskytuje rôzne metódy, ktoré vám umožňujú určiť schopnosti senzora.</p> <ul> <li><code>SensorEvent</code></li> </ul> <p>Systém používa túto triedu na vytvorenie objektu udalosti senzora, ktorý poskytuje informácie o udalosti ktorú emitoval senzor. Objekt <code>SenzorEvent</code> obsahuje nasledujúce informácie: prvotné údaje senzora, typ senzora, ktorý generoval udalosť, presnosť údajov a časové razítko udalosti.</p> <ul> <li><code>SensorEventListener</code></li> </ul> <p>Toto rozhranie môžete použiť na vytvorenie dvoch metód spätného volania, ktoré prijímajú oznámenia (udalosti senzora) pri zmene hodnôt senzora alebo pri zmene presnosti senzora.</p> <h3 id=identifikovanie-senzorov-a-ich-vlastnosti>Identifikovanie senzorov a ich vlastnosti<a class=headerlink href=#identifikovanie-senzorov-a-ich-vlastnosti title="Permanent link">&para;</a></h3> <p><strong>Získanie inštancie triedy <code>SensorManager</code></strong> Tento krok predstavuje vstupný bod, ktorý je nutné spraviť, aby sme vedeli pristupovať k senzor framework-u. </p> <div class=highlight><pre><span></span><code><span class=kd>private</span> <span class=n>SensorManager</span> <span class=n>mSensorManager</span><span class=p>;</span>
<span class=p>...</span>
<span class=n>mSensorManager</span> <span class=o>=</span> <span class=p>(</span><span class=n>SensorManager</span><span class=p>)</span> <span class=n>getSystemService</span><span class=p>(</span><span class=n>Context</span><span class=p>.</span><span class=na>SENSOR_SERVICE</span><span class=p>);</span> 
</code></pre></div> <p>Pomocou inštancie triedy <code>SensorManager</code> si vieme vyžiadať zoznam dostupných senzorov. Vyžiadame si buď celý zoznam alebo iba určitú kategóriu: </p> <ul> <li><code>TYPE_ALL</code> - všetky dostupné senzory</li> <li>TYPE_GYROSCOPE<code>,</code>TYPE_LINEAR_ACCELERATION<code>,</code>TYPE_GRAVITY`</li> </ul> <div class=highlight><pre><span></span><code><span class=n>List</span><span class=o>&lt;</span><span class=n>Sensor</span><span class=o>&gt;</span> <span class=n>deviceSensors</span> <span class=o>=</span> <span class=n>mSensorManager</span><span class=p>.</span><span class=na>getSensorList</span><span class=p>(</span><span class=n>Sensor</span><span class=p>.</span><span class=na>TYPE_ALL</span><span class=p>);</span> 
</code></pre></div> <p>Overenie či daný senzor existuje na zariadení pomocou <a href=https://developer.android.com/reference/android/hardware/SensorManager#getDefaultSensor(int)><code>getDefaultSensor()</code></a>. Ak daný senzor v zariadení existuje, tak vráti inštanciu objektu <code>Senzor</code>. Ak zariadenie obsahuje viac ako jeden senzor daného typu, jeden zo senzorov musí byť označený ako predvolený senzor. Ak pre daný typ senzora neexistuje predvolený senzor, volanie metódy vráti hodnotu <code>null</code>, čo znamená, že takýto typ senzora nie je v zariadení osadený. <div class=highlight><pre><span></span><code><span class=kd>private</span> <span class=n>SensorManager</span> <span class=n>mSensorManager</span><span class=p>;</span>
<span class=p>...</span>
<span class=n>mSensorManager</span> <span class=o>=</span> <span class=p>(</span><span class=n>SensorManager</span><span class=p>)</span> <span class=n>getSystemService</span><span class=p>(</span><span class=n>Context</span><span class=p>.</span><span class=na>SENSOR_SERVICE</span><span class=p>);</span>
<span class=k>if</span> <span class=p>(</span><span class=n>mSensorManager</span><span class=p>.</span><span class=na>getDefaultSensor</span><span class=p>(</span><span class=n>Sensor</span><span class=p>.</span><span class=na>TYPE_MAGNETIC_FIELD</span><span class=p>)</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>){</span>
  <span class=c1>// Success! There&#39;s a magnetometer.</span>
  <span class=p>}</span>
<span class=k>else</span> <span class=p>{</span>
  <span class=c1>// Failure! No magnetometer.</span>
  <span class=p>}</span> 
</code></pre></div></p> <p>Pomocou získaného objektu <a href=https://developer.android.com/reference/android/hardware/Sensor><code>Senzor</code></a> vieme určit aj ďalšie vlastnosti konkrétneho senzora tak, že zavoláme príslušné metódy napr:</p> <table> <thead> <tr> <th></th> <th>Verejné metódy</th> </tr> </thead> <tbody> <tr> <td><code>int</code></td> <td><code>getMaxDelay()</code></td> </tr> <tr> <td><code>float</code></td> <td><code>getMaximumRange()</code></td> </tr> <tr> <td><code>int</code></td> <td><code>getMinDelay()</code></td> </tr> <tr> <td><code>String</code></td> <td><code>getName()</code></td> </tr> <tr> <td><code>float</code></td> <td><code>getPower()</code></td> </tr> <tr> <td><code>int</code></td> <td><code>getReportingMode()</code></td> </tr> <tr> <td><code>float</code></td> <td><code>getResolution()</code></td> </tr> <tr> <td><code>String</code></td> <td><code>getStringType()</code></td> </tr> <tr> <td><code>int</code></td> <td><code>getType()</code></td> </tr> <tr> <td><code>String</code></td> <td><code>getVendor()</code></td> </tr> <tr> <td><code>int</code></td> <td><code>getVersion()</code></td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>Vzorkovacia frekvencia</p> <p>Metóda<code>getMinDelay()</code>je užitočná ak chceme získať informáciu aká je maximálna vzorkovacia frekvencia. Táto premenná vracia minimálnu periódu vzorkovania v mikrosekundách na výpočet vzorkovacej frekvencie použije známy vzorec: $$ f_{vzorkovacia} = \frac{1}{getMinDelay()\times10^6}[Hz] $$</p> </div> <div class="admonition warning"> <p class=admonition-title>Ak metóda <code>getMinDelay()</code> vráti 0 tak v tomto prípade senzor vyvolá udalosť iba pri zmene meranej veličiny</p> </div> <h3 id=komunikacia-so-senzormi>Komunikácia so senzormi<a class=headerlink href=#komunikacia-so-senzormi title="Permanent link">&para;</a></h3> <p>Komunikácia so senzorom prebieha asynchrónnym spôsobom. Senzory Androidu sú riadené externými službami a komunikujú na základe odosielania udalosti. Aplikácia sa musí zaregistrovať na príjem týchto udalostí implementovaním rozhrania <code>SensorEventListener</code>. V rozhraní <a href=https://developer.android.com/reference/android/hardware/SensorEventListener><code>SensorEventListener</code></a> existujú dve metódy spätného volania tzv callback metódy <code>onAccuracyChanged()</code>a <code>onSensorChanged()</code>. </p> <p>Android volá tieto metódy vždy, keď nastane táto situácia:</p> <ul> <li>Ak sa zmení presnosť senzora systém volá metódu <code>onAccuracyChanged()</code> a poskytne referenciu na <code>Sensor</code>objekt, ktorého sa daná situácia týka.</li> <li>Ak senzor načíta novú hodnotu systém volá metódu <code>onSensorChanged()</code> a poskytne referenciu na <a href=https://developer.android.com/reference/android/hardware/SensorEvent><code>SensorEvent</code></a>. Tento objekt obsahuje nasledujúce atribúty:</li> </ul> <table> <thead> <tr> <th align=left>Atribúty</th> <th></th> </tr> </thead> <tbody> <tr> <td align=left><code>public int</code></td> <td><code>accuracy</code><br>Presnosť tejto udalosti.</td> </tr> <tr> <td align=left><code>public Sensor</code></td> <td><code>sensor</code> <br>Senzor, ktorý generoval túto udalosť.</td> </tr> <tr> <td align=left><code>public long</code></td> <td><code>timestamp</code><br>Čas v nanosekundách, v ktorom sa udalosť stala</td> </tr> <tr> <td align=left><code>public final float[]</code></td> <td><code>values</code><br>Dĺžka a obsah poľa <code>values</code> závisí od toho, pre ktorý typ senzoru bol daný objekt vytvorený.</td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>Atribút <code>SensorEvent.values</code></p> <p>Dôležité je si uvedomiť, že objekt <code>SensorEvent</code> sa používa pre všetky typy senzorov, ktoré poskytujú rôzne dáta a preto na pole hodnôt<code>values</code> sa treba pozrieť vždy v kontexte konkrétneho senzora, ktorý určuje čo uloží do daného poľa. </p> </div> <p><img alt src=../diagrams/out/sensor_comm.svg#center></p> <blockquote> <p>Zaregistrovania odberu udalostí od senzora</p> <div class=highlight><pre><span></span><code> <span class=nd>@Override</span>
  <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onResume</span><span class=p>()</span> <span class=p>{</span>
    <span class=kd>super</span><span class=p>.</span><span class=na>onResume</span><span class=p>();</span>
    <span class=n>mSensorManager</span><span class=p>.</span><span class=na>registerListener</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=n>mLight</span><span class=p>,</span><span class=n>SensorManager</span><span class=p>.</span><span class=na>SENSOR_DELAY_NORMAL</span><span class=p>);</span>
  <span class=p>}</span> 
</code></pre></div> </blockquote> <p>Pri registrácii sme definovali pomocou konštanty <code>SENSOR_DELAY_NORMAL</code>, minimálnu vzorkovaciu frekvenciu alebo inak povedané maximálny čas medzi vzorkami. Pre každý typ aplikácie je vhodne vybrať túto hodnota tak, aby zodpovedala požiadavkám, ktoré sú kladené na aplikáciu. Zároveň však treba brať do úvahy výpočtové a s tým späté aj energetické nároky, ktoré vyplývajú z použitia senzora a nastavenia veľmi vysokej vzorkovacej frekvencie. Exitujú tieto konštanty, ktoré majú napomôcť vybrať vhodnú vzorkovaciu frekvenciu: už spomenutá <code>SENSOR_DELAY_NORMAL</code> a potom <a href=https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_DELAY_GAME><code>SENSOR_DELAY_GAME</code></a>,<a href=https://developer.android.com/reference/android/hardware/SensorManager#SENSOR_DELAY_UI><code>SENSOR_DELAY_UI</code></a>, alebo špecifická hodnota zadaná v mikrosekundách. </p> <p>Ako už bolo spomenuté v predchádzajúcich častiach, vzorkovacia frekvencia sa môže meniť vzhľadom na to, že senzory sú zdielané medzi všetkými aplikáciami. Ak iná aplikácia potrebuje vyššiu vzorkovaciu frekvenciu, tak aj naša aplikácia bude dostávať údaju častejšie. Neexistuje metóda pomocou ktorej by sa dala určiť aktuálna vzorkovacia frekvencia, jediná možnosť je určiť ju nepriamo pomocou časovej známky, ktorá je obsiahnutá v objekte <code>SensorEvent</code>. </p> <hr> <blockquote> <p>Zrušenie registrácie odberu udalostí od senzora</p> <div class=highlight><pre><span></span><code> <span class=nd>@Override</span>
  <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onPause</span><span class=p>()</span> <span class=p>{</span>
    <span class=kd>super</span><span class=p>.</span><span class=na>onPause</span><span class=p>();</span>
    <span class=n>mSensorManager</span><span class=p>.</span><span class=na>unregisterListener</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
  <span class=p>}</span> 
</code></pre></div> </blockquote> <div class="admonition warning"> <p class=admonition-title>Životný cyklus</p> <p>Pri práci so senzormi nesmieme zabudnúť na životný cyklus aplikácie a preto registrovanie a odregistrovanie vykonávame v metódach životného cyklu <code>onResume</code>, <code>onPause</code> tak aby sme zbytočne nepoužívali senzory, ktoré už nepotrebujeme (znižovanie spotreby). <strong>Systém senzory nevypína automaticky!</strong></p> </div> <hr> <blockquote> <p>Komplexný príklad použitia Frameworku na prácu so senzormi</p> <div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SensorActivity</span> <span class=kd>extends</span> <span class=n>Activity</span> <span class=kd>implements</span> <span class=n>SensorEventListener</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>SensorManager</span> <span class=n>sensorManager</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>Sensor</span> <span class=n>mLight</span><span class=p>;</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kd>final</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span>
        <span class=n>setContentView</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>main</span><span class=p>);</span>

        <span class=n>sensorManager</span> <span class=o>=</span> <span class=p>(</span><span class=n>SensorManager</span><span class=p>)</span> <span class=n>getSystemService</span><span class=p>(</span><span class=n>Context</span><span class=p>.</span><span class=na>SENSOR_SERVICE</span><span class=p>);</span>
        <span class=n>mLight</span> <span class=o>=</span> <span class=n>sensorManager</span><span class=p>.</span><span class=na>getDefaultSensor</span><span class=p>(</span><span class=n>Sensor</span><span class=p>.</span><span class=na>TYPE_LIGHT</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kd>final</span> <span class=kt>void</span> <span class=nf>onAccuracyChanged</span><span class=p>(</span><span class=n>Sensor</span> <span class=n>sensor</span><span class=p>,</span> <span class=kt>int</span> <span class=n>accuracy</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Do something here if sensor accuracy changes.</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kd>final</span> <span class=kt>void</span> <span class=nf>onSensorChanged</span><span class=p>(</span><span class=n>SensorEvent</span> <span class=n>event</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// The light sensor returns a single value.</span>
        <span class=c1>// Many sensors return 3 values, one for each axis.</span>
        <span class=kt>float</span> <span class=n>lux</span> <span class=o>=</span> <span class=n>event</span><span class=p>.</span><span class=na>values</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>;</span>
        <span class=c1>// Do something with this sensor value.</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onResume</span><span class=p>()</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onResume</span><span class=p>();</span>
        <span class=n>sensorManager</span><span class=p>.</span><span class=na>registerListener</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=n>mLight</span><span class=p>,</span> <span class=n>SensorManager</span><span class=p>.</span><span class=na>SENSOR_DELAY_NORMAL</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onPause</span><span class=p>()</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onPause</span><span class=p>();</span>
        <span class=n>sensorManager</span><span class=p>.</span><span class=na>unregisterListener</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </blockquote> <h3 id=vysporiadanie-sa-s-roznorodostou-android-zariadeni>Vysporiadanie sa s rôznorodosťou Android zariadení<a class=headerlink href=#vysporiadanie-sa-s-roznorodostou-android-zariadeni title="Permanent link">&para;</a></h3> <p>Na zistenie prítomnosti daného senzora v zariadení máme dve komplementárne možnosti: </p> <ul> <li> <p><strong>Detegovať senzory za behu</strong> a podľa potreby zapnúť alebo vypnúť funkcie aplikácie. <div class=highlight><pre><span></span><code><span class=kd>private</span> <span class=n>SensorManager</span> <span class=n>sensorManager</span><span class=p>;</span>
<span class=p>...</span>
<span class=n>sensorManager</span> <span class=o>=</span> <span class=p>(</span><span class=n>SensorManager</span><span class=p>)</span> <span class=n>getSystemService</span><span class=p>(</span><span class=n>Context</span><span class=p>.</span><span class=na>SENSOR_SERVICE</span><span class=p>);</span>
<span class=k>if</span> <span class=p>(</span><span class=n>sensorManager</span><span class=p>.</span><span class=na>getDefaultSensor</span><span class=p>(</span><span class=n>Sensor</span><span class=p>.</span><span class=na>TYPE_PRESSURE</span><span class=p>)</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>){</span>
    <span class=c1>// Success! There&#39;s a pressure sensor.</span>
<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
    <span class=c1>// Failure! No pressure sensor.</span>
<span class=p>}</span>
</code></pre></div></p> </li> <li> <p><strong>Použitie filtrov v službe Google Play</strong> - zakázanie inštalácie aplikácie už priamo v obchode Google Play.</p> <ul> <li>Tento filter sa nastavuje v <code>AndroidManifest.xml</code> súbore pomocou xml elementu <a href=https://developer.android.com/guide/topics/manifest/uses-feature-element><code>&lt;user-feature&gt;</code></a></li> </ul> <div class=highlight><pre><span></span><code><span class=nt>&lt;uses-feature</span> <span class=na>android:name=</span><span class=s>&quot;android.hardware.sensor.accelerometer&quot;</span>
<span class=na>android:required=</span><span class=s>&quot;true&quot;</span> <span class=nt>/&gt;</span>
</code></pre></div> <ul> <li><code>android:required=</code>určuje, či daný senzor je nevyhnutný pre fungovanie aplikácie. Hodnota <code>false</code>, dovolí aplikáciu nainštalovať aj keď daný senzor nie je v zariadení prítomný, aplikácia sa musí tomu prispôsobiť. </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Pre prehladnosť sa odporúča všetky používané senzory aj tie nie kritické pre chod aplikácie, zapísať do <code>AndroidManifest.xml</code> súboru.</p> </div> </li> </ul> <h3 id=suradnicovy-system-senzorov>Súradnicový systém senzorov<a class=headerlink href=#suradnicovy-system-senzorov title="Permanent link">&para;</a></h3> <p>Pri práci so senzormi, ktoré z princípu činnosti merajú dáta v osiach, Android využíva štandardný 3-osový súradnicový systém. Pre väčšinu senzorov je súradnicový systém definovaný vzhľadom na obrazovku zariadenia, keď je zariadenie držané v takzvanej natívnej polohe (pozri obrázok) . Ak je zariadenie držané v tejto polohe os X je vodorovná a ukazuje doprava, os Y je zvislá a ukazuje nahor a os Z ukazuje smerom k vonkajšej strane obrazovky. V tomto systéme majú súradnice za obrazovkou záporné hodnoty Z. Tento súradnicový systém používajú nasledujúce senzory: accelerometer, gravitačný senzor, gyroskop, lineárna akcelerácia, senzor geomagnetického poľa (kompas) </p> <blockquote> <p>Súradnicový systém používaný v Android OS <img alt=img src=../images/axis_device.png#center></p> </blockquote> <p><strong>Dôležité vlastnosti:</strong></p> <ul> <li>Je dôležité si pamätať, že osy pri zmene orientácie obrazovky sa nemenia/nevymieňajú- súradnicový systém sa nikdy nemení. </li> <li>Natívna poloha nemusí byť vždy taká, že zariadenie je orientované na výšku. Pri mnohých tabletových zariadeniach je prirodzená orientácia na šírku. Súradnicový systém senzorov je vždy založený na natívnej orientácii zariadenia.</li> <li>Ak aplikácia chce využiť údaje senzora a transformovať na súradnice displeja, musíme použiť metódu<code>getRotation()</code>na určenie rotácie obrazovky a následne použiť metódu <code>remapCoordinateSystem()</code> pomocou ktorej sa mapujú súradnice senzora na súradnice obrazovky. </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Niektoré senzory a metódy používajú súradnicový systém, ktorý je relatívny k svetovému referenčnému rámcu (na rozdiel od referenčného rámca zariadenia). Tieto senzory a metódy vracajú údaje, ktoré predstavujú pohyb zariadenia alebo polohu zariadenia vzhľadom na Zem. Pre viac informácií viď <a href=https://developer.android.com/reference/android/hardware/SensorManager#getOrientation(float[],%20float[])><code>getOrientation()</code></a>metóda, <a href="https://developer.android.com/reference/android/hardware/SensorManager#getRotationMatrix(float[], float[], float[], float[])"><code>getRotationMatrix()</code></a> metóda, <a href=https://developer.android.com/guide/topics/sensors/sensors_position#sensors-pos-orient>senzor orientácie</a> a <a href=https://developer.android.com/guide/topics/sensors/sensors_motion#sensors-motion-rotate>senzor rotácie</a> .</p> </div> <h3 id=osvedcene-postupy-pre-pristup-a-pouzivanie-senzorov>Osvedčené postupy pre prístup a používanie senzorov<a class=headerlink href=#osvedcene-postupy-pre-pristup-a-pouzivanie-senzorov title="Permanent link">&para;</a></h3> <ul> <li>Senzory používajte iba keď je aplikácia v popredí</li> <li>od verzie Android 9 sa aplikácie, ktoré <strong>bežia na pozadí</strong> musia prispôsobiť nasledujúcim obmedzeniam:<ul> <li>V prípade <a href=https://source.android.com/devices/sensors/report-modes#continuous>nepretržitého</a> vzorkovania, napr. senzor akceleromer, gyroskop, aplikácia nedostáva nové dáta. </li> <li>V prípade jednorázového merania alebo udalosti o zmene meranej hodnoty, aplikácia taktiež nedostáva nové dáta.</li> </ul> </li> <li>Vzhľadom na tieto obmedzenia je nutné používať senzor iba keď je aplikácia v popredí alebo využiť <a href=https://developer.android.com/guide/components/services#Foreground><code>ForegroundService</code> </a></li> <li>Dbať na dodržiavanie životného cyklu aplikácie, t.j. <code>onPause()</code> odhlásiť príjem, udalostí od senzora.</li> <li>Testovanie senzorov pomocou <strong><a href=https://developer.android.com/guide/topics/sensors/sensors_overview#test-with-the-android-emulator>Android Emulatora</a></strong></li> <li>Neblokovať metódu <code>onSensorChanged()</code></li> <li>Nepoužívajte metódy alebo typy snímačov, ktoré sú označené ako <code>deprecated</code> t.j. zastarané</li> <li>Pred použitím senzorov treba overiť či je senzor naozaj prítomný v zariadení</li> <li>Treba správne zvoliť vzorkovaciu frekvenciu - treba zabrániť zbytočnému plytvaniu CPU a energiou </li> </ul> <h2 id=urcenie-polohy-satelitna-navigacia>Určenie polohy / Satelitná navigácia<a class=headerlink href=#urcenie-polohy-satelitna-navigacia title="Permanent link">&para;</a></h2> <p>Android poskytuje lokalizáciu na základe rôznych metód:</p> <ul> <li>triangulácia na základe BTS,</li> <li>WiFi prístupové body</li> <li>a najčastejšie GPS.</li> </ul> <p>Cieľom tohoto riešenia je docieliť, čo najlepšie lokalizačné služby v rôznych podmienkach a obmedzeniach. Lokalizácia v exteriéry, v interiéri, malá spotreba energie, rýchla dostupnosť a požadovaná presnosť. To sú požiadavky, ktoré sú kladené na lokalizačné služby. Android OS má dva možné prístupy k takýmto lokalizačným službám. </p> <ol> <li><a href=https://developer.android.com/reference/android/location/package-summary><code>android.location</code></a> je API, ktoré poskytuje priamy prístup k lokalizačným službám. Tento prístup je nízko úrovňový a aby bola aplikácia optimalizovaná je potrebné, aby programátor mal dobré znalosti tejto problematiky. S každou novou verziou Android OS sa čiastočne menia podmienky, akým spôsobom sa k lokalizačným službám pristupuje a pri využití tohoto API je "na pleciach programátora" prispôsobiť aplikáciu aby fungovala aj na novšej verzii Andorid-u. <strong>Pre všetky tieto nevýhody nie je odporúčané používať tento nízko úrovňový prístup</strong>. Odporúčané je využívať prístup vyššej úrovne, ktorý je popísaný v nasledujúcej časti. </li> <li>Rozhranie <a href=https://developer.android.com/reference/com/google/android/gms/location/package-summary>Google Location Services API</a> , ktoré je súčasťou služieb Google Play, je preferovaným spôsobom, ako do aplikácie pridať lokalizačné služby. Ponúka jednoduchšie API, vyššiu presnosť, 'geofencing' s nízkou spotrebou a ďalšie.</li> </ol> <h3 id=sluzba-google-location-api>Služba Google Location API<a class=headerlink href=#sluzba-google-location-api title="Permanent link">&para;</a></h3> <p>Táto služba je súčasťou rozsiahleho balíka Google play services [<a href=https://developers.google.com/location-context> Location and Context APIs</a>]. Tento balík obsahuje nasledujúce doplnkové služby:</p> <p><strong>Poloha:</strong></p> <ul> <li><a href=https://developers.google.com/places/ ><strong>Places API</strong></a> - Poskytuje používateľom kontextové informácie o tom, kde sa nachádzajú a čo sa nachádza v ich okolí. Získate prístup k podrobným informáciám o 100 miliónoch miest v rôznych kategóriách.</li> <li><a href=https://developers.google.com/location-context/geofencing/ ><strong>Geofencing</strong></a> - Geofencing kombinuje znalosť aktuálnej polohy používateľa a vedomosti o vzdialenosti používateľa k miestam, ktoré môžu byť zaujímavé.<ul> <li>Umožňuje nastaviť zemepisné hranice okolo konkrétnych miest a následne prijímať oznámenia, keď užívateľ vstúpi alebo opustí tieto oblasti. </li> <li>Možnosť nastaviť viacero sledovaných oblastí.</li> <li>Možnosť vytvorenia filtrov.</li> <li>Optimalizovanie pre výdrž baterie: prispôsobenie frekvencie aktualizácií na základe polohy užívateľa a charakteru pohybu užívateľa (bez pohybu, chôdza, jazda autom, atď). </li> </ul> </li> <li><a href=https://developers.google.com/location-context/fused-location-provider/ ><strong>Location API</strong></a> - Získajte údaje o polohe pre svoju aplikáciu na základe kombinovaných signálov zo senzorov zariadenia pomocou rozhrania API účinného na batérie.</li> </ul> <p><strong>Činnosť</strong></p> <ul> <li><a href=https://developers.google.com/fit/ ><strong>Platforma Google Fit</strong></a> - záznam, spravovanie, vizualizácia fitness aktivít</li> <li><a href=https://developers.google.com/location-context/activity-recognition/ ><strong>API rozhranie na rozpoznávanie aktivity</strong></a> - toto rozhranie spracováva signály z viacerých senzorov pričom dbá na nízku spotrebu zariadenia, aby presne detegovalo aktuálnu aktivitu používateľa.</li> <li><a href=http://developer.android.com/guide/topics/sensors/sensors_overview.html><strong>Senzor API</strong></a> - prístup k dátam zo senzorov</li> </ul> <p><strong>Čo je v okolí:</strong></p> <ul> <li><a href=https://developers.google.com/nearby/messages><strong>Správy z okolia</strong></a></li> <li><a href=https://developers.google.com/nearby/connections><strong>Možnosť pripojiť sa na zariadenia v okolí</strong></a></li> <li><a href=https://developers.google.com/nearby/notifications><strong>Upozornenia z okolia</strong> </a> - služba zanikla v roku 2018</li> </ul> <div class="admonition warning"> <p class=admonition-title>Použitie Location API vyžaduje <a href=https://developers.google.com/android/guides/setup>Google Play services</a> !</p> </div> <p><strong>Základné vlastnosti Location API:</strong></p> <p>Poskytovateľ polohy inteligentne riadi nízko úrovňové technológie a na základe požiadaviek na presnosť vracia čo najlepšie údaje o polohe. Požiadavky na presnosť sú určené intervalom "Vysoká presnosť" a "Nízka spotreba"</p> <ul> <li>Okamžitá dostupnosť</li> <li>aplikácia má okamžitý prístup k najlepšej aktuálnej polohe. Klasický proces získavania polohy môže trvať aj niekoľko desiatok sekúnd kým sa získa poloha s GPS systému. Okamžitá informácia o polohe je častokrát získaná z histórie polohy, ktorú si vyžiadala iná aplikácia. Z toho vyplýva, že presnosť tejto polohy nemusí byť dobrá, ale dá sa využiť na prvotné prispôsobenie kontextu aplikácie, ktorý sa po získaní presnejšej polohy znova upraví. </li> <li>Energetická efektívnosť</li> <li>minimalizovanie spotreby, na základe požiadaviek. Location API robí automatický výber najvhodnejších nastavení, pre dané požiadavky na presnosť.</li> <li>napr. aplikácia na popredí dostáva dáta z vysokou presnosťou, pri prechode aplikácie do pozadia sa presnosť obmedzí na periodické upozornenie na zmenu polohy. </li> </ul> <h4 id=uzitocne-odkazy>Užitočné odkazy<a class=headerlink href=#uzitocne-odkazy title="Permanent link">&para;</a></h4> <ul> <li><a href=http://developer.android.com/google/play-services/setup.html>Nastavenie Google Play services</a></li> <li> <p><a href=https://developer.android.com/training/permissions/requesting.html>Kontrola povolenia a získanie povolenia (permissions)</a></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Pri práci s mnohými API treba zistiť aké povolenia dané API vyžaduje. V starších verziách Android bolo postačujúce pridať dané povolenie do <code>AndroidManifest.xml</code> a užívateľ pri inštalácií potvrdil/zamietol pridelenie daného povolenia. Toto už, ale nie je postačujúce pri novších verziách Android OS, kde je už povinnosť si vyžiadať dané povolenie aj pri samotnom behu aplikácie, viď odkaz vyššie.</p> </div> </li> <li> <p>Príklady na prácu s Location API:</p> <ul> <li><a href=https://developer.android.com/training/permissions/requesting.html>Získanie poslednej známej pozície</a></li> <li><a href=https://github.com/googlesamples/android-play-location/blob/master/LocationUpdates/app/src/main/java/com/google/android/gms/location/sample/locationupdates/MainActivity.java>Pravidelná aktualizácia polohy</a></li> </ul> </li> </ul> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=.. title="Procesy a vlákna (multithreding)" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Procesy a vlákna <small>(multithreding)</small> </div> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.36cbf620.min.js></script> <script src=../assets/javascripts/bundle.00c583dd.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs", "instant"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>